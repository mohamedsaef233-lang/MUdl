<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedBuild3D</title>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/OBJLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>
    <style>
        :root {
            --primary: #1a73e8;
            --secondary: #34a853;
            --accent: #4285f4;
            --medical-blue: #1e88e5;
            --medical-green: #43a047;
            --medical-teal: #00acc1;
            --dark: #2c387e;
            --light: #f8fdff;
            --card-1: linear-gradient(135deg, #1e88e5 0%, #0d47a1 100%);
            --card-2: linear-gradient(135deg, #43a047 0%, #1b5e20 100%);
            --card-3: linear-gradient(135deg, #00acc1 0%, #006064 100%);
            --shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            --radius: 24px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'IBM Plex Sans Arabic', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            color: var(--dark);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .app-container {
            width: 100%;
            max-width: 440px;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            border: 1px solid #e3f2fd;
            display: none;
        }
        
        .active-page {
            display: block;
        }
        
        /* صفحة تسجيل الدخول */
        .login-container {
            width: 100%;
            max-width: 440px;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            border: 1px solid #e3f2fd;
            padding: 40px 30px;
            text-align: center;
        }
        
        .login-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--medical-blue), var(--medical-teal));
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 2.5rem;
        }
        
        .login-title {
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--dark);
            margin-bottom: 10px;
        }
        
        .login-subtitle {
            font-size: 1rem;
            color: #64748b;
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
            text-align: right;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .form-input {
            width: 100%;
            padding: 15px;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--medical-blue);
            box-shadow: 0 0 0 3px rgba(30, 136, 229, 0.1);
        }
        
        .login-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--medical-blue), var(--medical-teal));
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }
        
        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(30, 136, 229, 0.3);
        }
        
        .divider {
            display: flex;
            align-items: center;
            margin: 25px 0;
        }
        
        .divider::before, .divider::after {
            content: "";
            flex: 1;
            height: 1px;
            background: #e2e8f0;
        }
        
        .divider-text {
            padding: 0 15px;
            color: #64748b;
            font-size: 0.9rem;
        }
        
        .register-btn {
            width: 100%;
            padding: 15px;
            background: white;
            color: var(--medical-blue);
            border: 1px solid var(--medical-blue);
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .register-btn:hover {
            background: #f8fafc;
        }
        
        /* Header */
        .app-header {
            background: linear-gradient(135deg, var(--medical-blue), var(--medical-teal));
            padding: 40px 30px;
            text-align: center;
            position: relative;
        }
        
        .settings-btn {
            position: absolute;
            top: 25px;
            right: 25px;
            background: rgba(255, 255, 255, 0.2);
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-decoration: none;
            font-size: 1.3rem;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .settings-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }
        
        .logo {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.25);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .logo i {
            font-size: 2.5rem;
            color: white;
        }
        
        .app-title {
            font-size: 2.8rem;
            font-weight: 800;
            color: white;
            margin-bottom: 8px;
            letter-spacing: -1px;
        }
        
        .developer-name {
            font-size: 1.1rem;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 15px;
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            display: inline-block;
            backdrop-filter: blur(10px);
        }
        
        .app-subtitle {
            font-size: 1.1rem;
            font-weight: 400;
            color: rgba(255, 255, 255, 0.9);
            opacity: 0.9;
        }
        
        /* Main Content */
        .main-content {
            padding: 40px 30px;
            background: var(--light);
        }
        
        .features-grid {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .feature-card {
            border-radius: 20px;
            padding: 30px;
            color: white;
            display: flex;
            align-items: center;
            gap: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }
        
        .feature-card.theory {
            background: var(--card-1);
        }
        
        .feature-card.practice {
            background: var(--card-2);
        }
        
        .feature-card.tests {
            background: var(--card-3);
        }
        
        .feature-icon {
            width: 60px;
            height: 60px;
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.25);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .feature-content {
            flex: 1;
        }
        
        .feature-title {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .feature-description {
            font-size: 0.9rem;
            font-weight: 400;
            opacity: 0.9;
        }
        
        .feature-arrow {
            font-size: 1.2rem;
            opacity: 0.8;
        }
        
        /* Footer */
        .app-footer {
            background: linear-gradient(135deg, #2c387e, #1a237e);
            padding: 25px 30px;
            text-align: center;
            color: white;
            font-weight: 500;
            font-size: 0.9rem;
        }
        
        .copyright {
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .year {
            font-weight: 400;
            opacity: 0.9;
        }
        
        /* صفحة الشرح النظري */
        .theory-container {
            padding: 30px;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin: 20px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .theory-header {
            background: linear-gradient(135deg, var(--medical-blue), var(--medical-teal));
            padding: 25px;
            border-radius: 20px 20px 0 0;
            color: white;
            text-align: center;
            margin-bottom: 25px;
        }
        
        .theory-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .theory-subtitle {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        .theory-content {
            line-height: 1.8;
            color: #334155;
        }
        
        .theory-section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .section-heading {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--medical-blue);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-heading i {
            font-size: 1.2rem;
        }
        
        .theory-list {
            padding-right: 20px;
            margin-bottom: 15px;
        }
        
        .theory-list li {
            margin-bottom: 10px;
        }
        
        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: var(--medical-blue);
            color: white;
            padding: 12px 20px;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-top: 20px;
        }
        
        .back-btn:hover {
            background: var(--dark);
            transform: translateX(-5px);
        }
        
        /* صفحة الورشة العملية */
        .workshop-container {
            padding: 30px;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin: 20px;
            text-align: center;
        }
        
        .workshop-header {
            background: linear-gradient(135deg, var(--medical-green), #1b5e20);
            padding: 25px;
            border-radius: 20px 20px 0 0;
            color: white;
            margin-bottom: 25px;
        }
        
        .workshop-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .workshop-subtitle {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        #model-container {
            width: 100%;
            height: 500px;
            background: #000;
            border-radius: 16px;
            margin-bottom: 25px;
            border: 2px solid #e2e8f0;
            position: relative;
            overflow: hidden;
        }
        
        .model-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: white;
        }
        
        .model-loading i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--medical-green);
        }
        
        .workshop-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            padding: 12px 25px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 150px;
            justify-content: center;
        }
        
        .assemble-btn {
            background: var(--medical-green);
            color: white;
        }
        
        .disassemble-btn {
            background: #f1f5f9;
            color: var(--dark);
        }
        
        .reset-btn {
            background: var(--medical-blue);
            color: white;
        }
        
        .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .drag-instructions {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 12px;
            margin-top: 15px;
            text-align: center;
            color: var(--medical-blue);
            font-weight: 600;
        }
        
        /* صفحة الاختبارات */
        .quiz-container {
            padding: 30px;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin: 20px;
        }
        
        .quiz-header {
            background: linear-gradient(135deg, var(--medical-teal), #006064);
            padding: 25px;
            border-radius: 20px 20px 0 0;
            color: white;
            text-align: center;
            margin-bottom: 25px;
        }
        
        .quiz-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .quiz-subtitle {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        .question-counter {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .question-container {
            background: #f8fafc;
            padding: 25px;
            border-radius: 16px;
            margin-bottom: 25px;
        }
        
        .question-text {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 20px;
            line-height: 1.5;
        }
        
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .option {
            background: white;
            padding: 15px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #e2e8f0;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .option:hover {
            border-color: var(--medical-teal);
            transform: translateX(-5px);
        }
        
        .option-letter {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: #f1f5f9;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: var(--dark);
        }
        
        .option-text {
            flex: 1;
        }
        
        .lifelines-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 25px;
        }
        
        .lifeline {
            background: #f1f5f9;
            padding: 12px 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .lifeline:hover {
            background: var(--medical-teal);
            color: white;
        }
        
        .lifeline.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .lifeline.disabled:hover {
            background: #f1f5f9;
            color: var(--dark);
        }
        
        /* صفحة الإعدادات */
        .settings-container {
            padding: 30px;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin: 20px;
        }
        
        .settings-header {
            background: linear-gradient(135deg, var(--medical-blue), var(--medical-teal));
            padding: 25px;
            border-radius: 20px 20px 0 0;
            color: white;
            text-align: center;
            margin-bottom: 25px;
            position: relative;
        }
        
        .settings-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .settings-subtitle {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        .settings-section {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .section-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: var(--medical-blue);
            font-size: 1.2rem;
        }
        
        .settings-item {
            display: flex;
            align-items: center;
            padding: 18px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 1px solid #f8fafc;
        }
        
        .settings-item:last-child {
            border-bottom: none;
        }
        
        .settings-item:hover {
            background: #f8fafc;
            margin: 0 -15px;
            padding: 18px 15px;
            border-radius: 10px;
        }
        
        .item-icon {
            width: 45px;
            height: 45px;
            border-radius: 12px;
            background: #f1f5f9;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 15px;
            font-size: 1.2rem;
            color: var(--medical-blue);
            transition: all 0.3s ease;
        }
        
        .settings-item:hover .item-icon {
            background: var(--medical-blue);
            color: white;
        }
        
        .item-content {
            flex: 1;
        }
        
        .item-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 3px;
            font-size: 1rem;
        }
        
        .item-desc {
            font-size: 0.85rem;
            color: #64748b;
        }
        
        .item-arrow {
            color: #cbd5e1;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .settings-item:hover .item-arrow {
            color: var(--medical-blue);
            transform: translateX(-5px);
        }
        
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 26px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #cbd5e1;
            transition: .4s;
            border-radius: 34px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: var(--medical-blue);
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(24px);
        }
        
        .account-info {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            padding: 20px;
            border-radius: 16px;
            text-align: center;
            margin-bottom: 25px;
        }
        
        .user-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--medical-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            color: white;
            font-size: 2rem;
        }
        
        .user-name {
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 5px;
            font-size: 1.2rem;
        }
        
        .user-email {
            color: #64748b;
            font-size: 0.9rem;
        }
        
        /* نافذة الدعم الفني */
        .support-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            display: none;
        }
        
        .support-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }
        
        .support-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 20px;
        }
        
        .support-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .support-option {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .support-option:hover {
            border-color: var(--medical-blue);
            transform: translateX(-5px);
        }
        
        .support-icon {
            font-size: 2rem;
        }
        
        .whatsapp-icon {
            color: #25D366;
        }
        
        .phone-icon {
            color: var(--medical-blue);
        }
        
        .support-text {
            flex: 1;
            text-align: right;
        }
        
        .support-name {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 5px;
        }
        
        .support-desc {
            font-size: 0.85rem;
            color: #64748b;
        }
        
        .close-support {
            background: #f1f5f9;
            color: var(--dark);
            border: none;
            padding: 12px 25px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .close-support:hover {
            background: #e2e8f0;
        }
        
        /* Responsive */
        @media (max-width: 480px) {
            .app-container, .login-container {
                border-radius: 20px;
            }
            
            .app-header, .settings-header, .theory-header, .workshop-header, .quiz-header {
                padding: 30px 20px;
            }
            
            .app-title {
                font-size: 2.2rem;
            }
            
            .main-content, .theory-container, .workshop-container, .quiz-container, .settings-container {
                padding: 30px 20px;
            }
            
            .feature-card {
                padding: 25px;
            }
            
            .lifelines-container {
                flex-direction: column;
                gap: 10px;
            }
            
            #model-container {
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <!-- صفحة تسجيل الدخول -->
    <div class="login-container" id="login-page">
        <div class="login-logo">
            <i class="fas fa-stethoscope"></i>
        </div>
        <h1 class="login-title">MedBuild3D</h1>
        <p class="login-subtitle">تفكيك الأجهزة الطبية</p>
        
        <form id="login-form">
            <div class="form-group">
                <label class="form-label" for="email">البريد الإلكتروني أو رقم الهاتف</label>
                <input type="text" id="email" class="form-input" placeholder="أدخل بريدك الإلكتروني أو رقم هاتفك" required>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="password">كلمة المرور</label>
                <input type="password" id="password" class="form-input" placeholder="أدخل كلمة المرور" required>
            </div>
            
            <button type="submit" class="login-btn">تسجيل الدخول</button>
        </form>
        
        <div class="divider">
            <span class="divider-text">أو</span>
        </div>
        
        <button class="register-btn" id="register-btn">
            <i class="fas fa-user-plus"></i>
            إنشاء حساب جديد
        </button>
    </div>
    
    <!-- الصفحة الرئيسية -->
    <div class="app-container" id="main-page">
        <header class="app-header">
            <a href="#" class="settings-btn" id="settings-btn">
                <i class="fas fa-ellipsis-v"></i>
            </a>
            
            <div class="logo">
                <i class="fas fa-stethoscope"></i>
            </div>
            <h1 class="app-title">MedBuild3D</h1>
            <div class="developer-name">Saad Zaki Ibrahim</div>
            <p class="app-subtitle">تفكيك الأجهزة الطبية</p>
        </header>
        
        <main class="main-content">
            <div class="features-grid">
                <!-- زر النظري -->
                <div class="feature-card theory" id="theory-btn">
                    <div class="feature-icon">
                        <i class="fas fa-book-medical"></i>
                    </div>
                    <div class="feature-content">
                        <h2 class="feature-title">النظري</h2>
                        <p class="feature-description">شروحات الأجهزة الطبية</p>
                    </div>
                    <div class="feature-arrow">
                        <i class="fas fa-chevron-left"></i>
                    </div>
                </div>
                
                <!-- زر العملي -->
                <div class="feature-card practice" id="practice-btn">
                    <div class="feature-icon">
                        <i class="fas fa-tools"></i>
                    </div>
                    <div class="feature-content">
                        <h2 class="feature-title">العملي</h2>
                        <p class="feature-description">تدريب تفكيك وتجميع</p>
                    </div>
                    <div class="feature-arrow">
                        <i class="fas fa-chevron-left"></i>
                    </div>
                </div>
                
                <!-- زر الاختبارات -->
                <div class="feature-card tests" id="tests-btn">
                    <div class="feature-icon">
                        <i class="fas fa-star-of-life"></i>
                    </div>
                    <div class="feature-content">
                        <h2 class="feature-title">الاختبارات</h2>
                        <p class="feature-description">أسئلة وتقييم المستوى</p>
                    </div>
                    <div class="feature-arrow">
                        <i class="fas fa-chevron-left"></i>
                    </div>
                </div>
            </div>
        </main>
        
        <footer class="app-footer">
            <div class="copyright">جميع الحقوق محفوظة لدى MedBuild3D</div>
            <div class="year">© 2026</div>
        </footer>
    </div>
    
    <!-- صفحة الشرح النظري -->
    <div class="app-container" id="theory-page">
        <div class="theory-container">
            <div class="theory-header">
                <h2 class="theory-title">الشرح النظري</h2>
                <p class="theory-subtitle">جهاز الحمام المائي (Water Bath)</p>
            </div>
            
            <div class="theory-content">
                <div class="theory-section">
                    <h3 class="section-heading"><i class="fas fa-info-circle"></i> مقدمة</h3>
                    <p>يُستخدم حمام الماء المخبري لتسخين العينات في المختبر. تشمل بعض تطبيقاته المحافظة على خطوط الخلايا (cell lines) أو تسخين المواد الكيميائية القابلة للاشتعال التي قد تحترق إذا تعرضت للهب المكشوف. يتكون حمام الماء عموماً من وحدة تسخين، وحجرة من الفولاذ المقاوم للصدأ (ستانلس ستيل) تحمل الماء والعينات، وواجهة تحكم. توفر الأنواع المختلفة من حمامات الماء وظائف إضافية، مثل حمام الماء الدوراني (circulating water bath) الذي يحافظ على درجة حرارة أكثر اتساقاً، أو حمام الماء الهزاز (shaking water bath) الذي يحافظ على حركة العينات أثناء تسخينها. يُعد حمام الماء من المعدات المخبرية ذات درجة الحرارة الثابتة، ويوفر مصدر حرارة لمجموعة متنوعة من الأجهزة التي تحتاج إليه.</p>
                </div>
                
                <div class="theory-section">
                    <h3 class="section-heading"><i class="fas fa-cogs"></i> مبدأ عمل حمام الماء</h3>
                    <p>يعمل حمام الماء بوجود حساس لدرجة الحرارة (temperature sensor)، والذي ينقل درجة حرارة الماء في الجهاز إلى قيمة مقاومة، يتم تضخيمها ومقارنتها باستخدام مضخم متكامل، والذي بدوره يضع إشارات التحكم في المخرجات والمحتوى الأمثل. يحافظ هذا على طاقة تسخين أنبوب التسخين الكهربائي، وبالتالي يُبقي الحمام عند درجة حرارة ثابتة.</p>
                    <p>يعتبر الحمام جهاز تسخين، ويُستخدم فيه الماء كوسيط لنقل الحرارة إلى مكون محلول العينة. بما أن الماء يصل إلى درجة حرارة الغليان وهي 100°C، فلا ينبغي معالجة الأواني الزجاجية أو العينات الحساسة لدرجة الحرارة باستخدام هذه الطريقة.</p>
                    <p>يتراوح نطاق درجة الحرارة في حمام الماء بين 30°C و 100°C. للحفاظ على درجة الحرارة ثابتة، يستخدم حمام الماء الحرارة المتداولة لتوليد حركة أثناء التسخين داخل العينة. ولكن إذا كانت العينة تتطلب درجة حرارة أعلى من 100°C، يُفضل استخدام حمام الزيت أو الرمل أو السيليكون.</p>
                </div>
                
                <div class="theory-section">
                    <h3 class="section-heading"><i class="fas fa-puzzle-piece"></i> مكونات حمام الماء الساخن</h3>
                    <p>يتكون حمام الماء الساخن مما يلي:</p>
                    <ul class="theory-list">
                        <li><strong>الوعاء أو حوض الخزان (Container or Tank Bath):</strong> تُحفظ فيه عينات الاختبار في الماء الساخن لفترة طويلة من الزمن. يُصنع وعاء حمام الماء المخبري من معدن معزول مثل الفولاذ المقاوم للصدأ.</li>
                        <li><strong>غطاء الوعاء (Container Lid):</strong> يساعد الغطاء في تغطية الوعاء، حتى لا يتبخر الماء منه. يُصنع بشكل أساسي من زجاج مقاوم للحرارة أو معدن معزول.</li>
                        <li><strong>السخان (Heater):</strong> يحتوي حمام الماء المخبري على حساس حرارة Cu50، والذي يساعد في توليد الحرارة.</li>
                        <li><strong>مقياس الحرارة (Thermometer):</strong> يساعد هذا في فحص درجة حرارة حمام الماء. يمكن أن يكون مدمجاً أو يوضع بشكل منفصل.</li>
                        <li><strong>الثرموستات أو المنظم (Thermostat or regulator):</strong> يساعد الثرموستات في الحفاظ على درجة حرارة حمام الماء عند مستوى ثابت.</li>
                        <li><strong>الجهاز المروحي أو المحرك (Propeller or stirrer device):</strong> يساعد في تدوير الماء داخل حمام الماء (يوجد في حمامات الماء الدورانية) أو يمكن استخدام الشبكة (Shelves mesh) بدلاً من الجهاز المروحي او المحرك لأن الشبكة تستخدم في الحمام المائي الهزاز والجهاز المروحي يستخدم في الحمام المائي الدوراني وهي تساعد على رج الماء داخل الحمام المائي.</li>
                        <li><strong>المخرج (Outlet):</strong> يساعد في إخراج الماء من الوعاء.</li>
                        <li><strong>ضوء المؤشر (Indicator light):</strong> يجب أن تحتوي جميع حمامات الماء على ضوء مؤشر. عندما يكون الضوء مضاءً، يكون حمام الماء في وضع التسخين. إذا وصل حمام الماء إلى درجة الحرارة المطلوبة، ينطفئ الضوء للحفاظ على درجة الحرارة الثابتة.</li>
                    </ul>
                </div>
                
                <div class="theory-section">
                    <h3 class="section-heading"><i class="fas fa-list"></i> أنواع حمام الماء الساخن</h3>
                    <p>هناك أنواع عديدة لحمام الماء الساخن وهي كما يلي:</p>
                    <ul class="theory-list">
                        <li><strong>حمام الماء الهزاز (Shaking water bath):</strong> يحتوي هذا النوع من حمام الماء على تحكم إضافي بالاهتزاز (Shaking)، والذي يساعد في حركة الماء الساخن وعينة الاختبار السائلة. يمكن تشغيل ميزة الاهتزاز هذه أو إيقاف تشغيلها. في المختبرات الميكروبيولوجية، يساعد حمام الماء الهزاز في تحضين مزرعة نامية مع دوران مناسب للهواء.</li>
                        <li><strong>حمام الماء الدوراني (Circulating water bath):</strong> يُستخدم حمام الماء ذو المحرك (Stirrers) أو الدوراني في التجارب الإنزيمية والمصلية (serologic). في حمام الماء الدوراني، يتم تدوير الماء الساخن بشكل كامل في جميع أنحاء الحوض، مما يؤدي إلى درجة حرارة أكثر انتظاماً.</li>
                        <li><strong>حمام الماء غير الدوراني (Non-circulating water bath):</strong> تعتمد حمامات الماء غير الدورانية بشكل أساسي على الحمل الحراري (convection) بدلاً من تسخين الماء بشكل منتظم، مما ينتج عنه دقة أقل من حيث التحكم في درجة الحرارة.</li>
                    </ul>
                </div>
                
                <div class="theory-section">
                    <h3 class="section-heading"><i class="fas fa-exclamation-triangle"></i> قيود حمام الماء</h3>
                    <p>قيود حمام الماء هي:</p>
                    <ul class="theory-list">
                        <li>تغيير الماء يومياً والحفاظ على نظافته من الداخل لمنع تقشر المكونات الهامة في حمام الماء.</li>
                        <li>عند استخدام حمام الماء، يجب إبقاء الغطاء مغلقاً حتى لا يتبخر الماء.</li>
                        <li>قياس درجة الحرارة الداخلية والخارجية لحمام الماء مرة واحدة في الأسبوع.</li>
                        <li>التأكد من أن مقياس الحرارة لا يلتصق بجدار حمام الماء.</li>
                    </ul>
                </div>
                
                <div class="theory-section">
                    <h3 class="section-heading"><i class="fas fa-tools"></i> صيانة حمام الماء</h3>
                    <p>الصيانة المناسبة ضرورية لإطالة العمر الافتراضي، بغض النظر عن نوع حمام الماء الذي تستخدمه.</p>
                    <ul class="theory-list">
                        <li>أولاً: يجب مراعاة نوع الماء الذي ستستخدمه بعناية. يعمل الماء المقطر بشكل أفضل في حمامات الماء، لأن ماء الصنبور يمكن أن يحتوي على معادن تتراكم بمرور الوقت.</li>
                        <li>ثانياً: تأكد من تصريف حمام الماء في كل مرة للحفاظ عليه في حالة جيدة.</li>
                        <li>يحتاج هذا النوع من المعدات إلى التنظيف بانتظام. يجب التأكد من إيقاف تشغيله وإزالة الوعاء قبل التنظيف.</li>
                        <li>امسح السدادات (seals) لإزالة أي حطام، واحرص على عدم سكب الماء في الوحدة لأن ذلك قد يتلف المكونات الكهربائية.</li>
                        <li>لا تستخدم مواد تنظيف أكالة على حمام الماء، واستخدم فقط قطعة قماش مبللة ومنظفاً خفيفاً للتنظيف.</li>
                    </ul>
                </div>
                
                <div class="theory-section">
                    <h3 class="section-heading"><i class="fas fa-flask"></i> استخدامات حمام الماء</h3>
                    <p>يُستخدم حمام الماء على نطاق واسع في الأجهزة الطبية والمختبرات لتوفير درجات حرارة دقيقة وثابتة لتسخين العينات أو الحفاظ عليها. تشمل التطبيقات الشائعة ما يلي:</p>
                    <ul class="theory-list">
                        <li><strong>تحضير العينة (Sample Preparation)</strong>
                            <ul>
                                <li>إذابة العينات المجمدة (Thawing frozen samples).</li>
                                <li>تسخين المحاليل الكيميائية أو البيولوجية مثل البروتينات أو الأجسام المضادة.</li>
                                <li>تخفيف أو إذابة المستحضرات الصيدلانية.</li>
                            </ul>
                        </li>
                        <li><strong>تشخيص الأمراض (Disease Diagnostics)</strong>
                            <ul>
                                <li>يُستخدم في الاختبارات المعملية مثل تفاعل البوليميراز المتسلسل (PCR)، حيث تتطلب الإنزيمات درجات حرارة مستقرة.</li>
                                <li>تحليل الدم والبلازما لعوامل التخثر.</li>
                            </ul>
                        </li>
                        <li><strong>الزراعة الميكروبية (Microbial Cultivation)</strong>
                            <ul>
                                <li>الحفاظ على ظروف نمو محددة للكائنات الدقيقة.</li>
                                <li>إذابة أوساط الاستنبات (مثل الأجار) قبل الاستخدام.</li>
                            </ul>
                        </li>
                        <li><strong>اختبار الجودة (Quality Testing)</strong>
                            <ul>
                                <li>اختبار استقرار المنتجات الصيدلانية أو الغذائية في ظل درجات حرارة مختلفة.</li>
                                <li>تقييم الآثار الحرارية على المواد الطبية.</li>
                            </ul>
                        </li>
                        <li><strong>التطبيقات الجراحية (Surgical Applications)</strong>
                            <ul>
                                <li>تدفئة سوائل العمليات الجراحية، مثل المحاليل الملحية (saline solutions)، قبل إعطائها للمرضى لتجنب الصدمة الحرارية.</li>
                            </ul>
                        </li>
                        <li><strong>تطبيقات الأنسجة (Tissue Applications)</strong>
                            <ul>
                                <li>تحضير الأنسجة للمعالجة في أجهزة التثبيت والتلوين في علم الأمراض.</li>
                            </ul>
                        </li>
                    </ul>
                    <p><strong>ملاحظات:</strong></p>
                    <ul class="theory-list">
                        <li>يتم اختيار درجة الحرارة الدقيقة بناءً على التطبيق، وعادة ما تتراوح بين 25°C و 100°C</li>
                        <li>تعتمد معظم الأجهزة الطبية على حمامات الماء، بسبب قدرتها على توفير تسخين موحد ومتسق دون إتلاف العينات.</li>
                    </ul>
                </div>
                
                <a href="#" class="back-btn" id="theory-back-btn">
                    <i class="fas fa-arrow-right"></i>
                    العودة للصفحة الرئيسية
                </a>
            </div>
        </div>
    </div>
    
    <!-- صفحة الورشة العملية -->
    <div class="app-container" id="workshop-page">
        <div class="workshop-container">
            <div class="workshop-header">
                <h2 class="workshop-title">ورشة العمل التفاعلية</h2>
                <p class="workshop-subtitle">تدريب تفكيك وتجميع جهاز الحمام المائي</p>
            </div>
            
            <div id="model-container">
                <div class="model-loading">
                    <i class="fas fa-cube"></i>
                    <p>جاري تحميل النموذج ثلاثي الأبعاد...</p>
                </div>
            </div>
            
            <div class="workshop-controls">
                <button class="control-btn assemble-btn" id="assemble-btn">
                    <i class="fas fa-puzzle-piece"></i>
                    تجميع الجهاز
                </button>
                <button class="control-btn disassemble-btn" id="disassemble-btn">
                    <i class="fas fa-cogs"></i>
                    تفكيك الجهاز
                </button>
                <button class="control-btn reset-btn" id="reset-btn">
                    <i class="fas fa-redo"></i>
                    إعادة التعيين
                </button>
            </div>
            
            <div class="drag-instructions">
                <i class="fas fa-mouse-pointer"></i>
                يمكنك سحب الأجزاء وتحريكها في المساحة ثلاثية الأبعاد - تدوير: اسحب - تكبير/تصغير: حرك الإصبعين
            </div>
            
            <a href="#" class="back-btn" id="workshop-back-btn" style="margin-top: 30px;">
                <i class="fas fa-arrow-right"></i>
                العودة للصفحة الرئيسية
            </a>
        </div>
    </div>
    
    <!-- صفحة الاختبارات -->
    <div class="app-container" id="quiz-page">
        <div class="quiz-container">
            <div class="quiz-header">
                <h2 class="quiz-title">الاختبارات</h2>
                <p class="quiz-subtitle">اختبر معلوماتك حول جهاز الحمام المائي</p>
                <div class="question-counter">السؤال 1 من 15</div>
            </div>
            
            <div class="question-container">
                <div class="question-text" id="question-text">
                    ما هو الغرض الأساسي من الحمّام المائي في التطبيقات الطبية؟
                </div>
                
                <div class="options-container" id="options-container">
                    <!-- سيتم ملء الخيارات ديناميكياً -->
                </div>
            </div>
            
            <div class="lifelines-container">
                <div class="lifeline" id="fifty-fifty">
                    <i class="fas fa-user-friends"></i>
                    حذف إجابتين
                </div>
                <div class="lifeline" id="change-question">
                    <i class="fas fa-sync-alt"></i>
                    تغيير السؤال
                </div>
            </div>
            
            <a href="#" class="back-btn" id="quiz-back-btn">
                <i class="fas fa-arrow-right"></i>
                العودة للصفحة الرئيسية
            </a>
        </div>
    </div>
    
    <!-- صفحة الإعدادات -->
    <div class="app-container" id="settings-page">
        <div class="settings-container">
            <div class="settings-header">
                <a href="#" class="back-btn" id="settings-back-btn">
                    <i class="fas fa-arrow-right"></i>
                </a>
                <h2 class="settings-title">الإعدادات</h2>
                <p class="settings-subtitle">إدارة التطبيق والخصائص</p>
            </div>
            
            <div class="account-info">
                <div class="user-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="user-name" id="settings-username">مستخدم MedBuild3D</div>
                <div class="user-email" id="settings-email">user@medbuild3d.com</div>
            </div>
            
            <div class="settings-section">
                <div class="section-title">
                    <i class="fas fa-headset"></i>
                    <span>الدعم والمساعدة</span>
                </div>
                
                <div class="settings-item" id="support-settings">
                    <div class="item-icon">
                        <i class="fas fa-phone-alt"></i>
                    </div>
                    <div class="item-content">
                        <div class="item-title">الدعم الفني</div>
                        <div class="item-desc">+964 773 405 4850</div>
                    </div>
                    <div class="item-arrow">
                        <i class="fas fa-chevron-left"></i>
                    </div>
                </div>
                
                <div class="settings-item" id="about-settings">
                    <div class="item-icon">
                        <i class="fas fa-info-circle"></i>
                    </div>
                    <div class="item-content">
                        <div class="item-title">عن التطبيق</div>
                        <div class="item-desc">إصدار 1.0 | MedBuild3D</div>
                    </div>
                    <div class="item-arrow">
                        <i class="fas fa-chevron-left"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="item-icon">
                        <i class="fas fa-code"></i>
                    </div>
                    <div class="item-content">
                        <div class="item-title">المطور</div>
                        <div class="item-desc">Saad Zaki Ibrahim</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- نافذة الدعم الفني -->
    <div class="support-modal" id="support-modal">
        <div class="support-content">
            <h3 class="support-title">الدعم الفني</h3>
            
            <div class="support-options">
                <div class="support-option" id="whatsapp-support">
                    <div class="support-icon whatsapp-icon">
                        <i class="fab fa-whatsapp"></i>
                    </div>
                    <div class="support-text">
                        <div class="support-name">واتساب</div>
                        <div class="support-desc">تواصل معنا عبر واتساب</div>
                    </div>
                </div>
                
                <div class="support-option" id="phone-support">
                    <div class="support-icon phone-icon">
                        <i class="fas fa-phone-alt"></i>
                    </div>
                    <div class="support-text">
                        <div class="support-name">اتصال هاتفي</div>
                        <div class="support-desc">اتصل بنا مباشرة</div>
                    </div>
                </div>
            </div>
            
            <button class="close-support" id="close-support">إغلاق</button>
        </div>
    </div>

    <script>
        // بيانات المستخدم
        let currentUser = null;
        let isLoggedIn = false;
        
        // بيانات الأسئلة
        const quizQuestions = [
            {
                question: "ما هو الغرض الأساسي من الحمّام المائي في التطبيقات الطبية؟",
                options: [
                    "تبريد العينات",
                    "توفير بيئة تسخين مستقرة",
                    "تعقيم المعدات",
                    "خلط المواد الكيميائية"
                ],
                correctAnswer: "b"
            },
            {
                question: "ما هو نطاق درجة الحرارة النموذجي للحمّام المائي؟",
                options: [
                    "0°C إلى 50°C",
                    "30°C إلى 100°C",
                    "50°C إلى 150°C",
                    "100°C إلى 200°C"
                ],
                correctAnswer: "b"
            },
            // ... باقي الأسئلة
        ];
        
        let currentQuestionIndex = 0;
        let lifelinesUsed = {
            fiftyFifty: false,
            changeQuestion: false
        };
        
        // متغيرات Three.js
        let scene, camera, renderer, controls;
        let modelParts = [];
        let isAssembled = true;
        let selectedPart = null;
        let isDragging = false;
        let raycaster = new THREE.Raycaster();
        let mouse = new THREE.Vector2();
        let plane = new THREE.Plane();
        let planeNormal = new THREE.Vector3();
        let planePoint = new THREE.Vector3();
        let intersectionPoint = new THREE.Vector3();
        
        // عناصر DOM
        const loginPage = document.getElementById('login-page');
        const mainPage = document.getElementById('main-page');
        const theoryPage = document.getElementById('theory-page');
        const workshopPage = document.getElementById('workshop-page');
        const quizPage = document.getElementById('quiz-page');
        const settingsPage = document.getElementById('settings-page');
        const supportModal = document.getElementById('support-modal');
        
        const loginForm = document.getElementById('login-form');
        const registerBtn = document.getElementById('register-btn');
        const settingsBtn = document.getElementById('settings-btn');
        const theoryBtn = document.getElementById('theory-btn');
        const practiceBtn = document.getElementById('practice-btn');
        const testsBtn = document.getElementById('tests-btn');
        
        const theoryBackBtn = document.getElementById('theory-back-btn');
        const workshopBackBtn = document.getElementById('workshop-back-btn');
        const quizBackBtn = document.getElementById('quiz-back-btn');
        const settingsBackBtn = document.getElementById('settings-back-btn');
        
        const assembleBtn = document.getElementById('assemble-btn');
        const disassembleBtn = document.getElementById('disassemble-btn');
        const resetBtn = document.getElementById('reset-btn');
        
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        
        const fiftyFiftyBtn = document.getElementById('fifty-fifty');
        const changeQuestionBtn = document.getElementById('change-question');
        
        const supportSettings = document.getElementById('support-settings');
        const aboutSettings = document.getElementById('about-settings');
        
        const whatsappSupport = document.getElementById('whatsapp-support');
        const phoneSupport = document.getElementById('phone-support');
        const closeSupport = document.getElementById('close-support');
        
        // التحقق من حالة تسجيل الدخول
        function checkLoginStatus() {
            const savedUser = localStorage.getItem('medbuild3d_user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                isLoggedIn = true;
                showPage(mainPage);
                document.getElementById('settings-username').textContent = currentUser.username;
                document.getElementById('settings-email').textContent = currentUser.email;
            } else {
                showPage(loginPage);
            }
        }
        
        // وظائف التنقل بين الصفحات
        function showPage(page) {
            // إخفاء جميع الصفحات
            const pages = [loginPage, mainPage, theoryPage, workshopPage, quizPage, settingsPage];
            pages.forEach(p => p.classList.remove('active-page'));
            
            // إظهار الصفحة المطلوبة
            page.classList.add('active-page');
            
            // إذا كانت صفحة الورشة، قم بتهيئة النموذج ثلاثي الأبعاد
            if (page === workshopPage) {
                setTimeout(() => {
                    init3DModel();
                }, 100);
            }
        }
        
        // تسجيل الدخول - الانتقال المباشر
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            if (email && password) {
                currentUser = {
                    username: email.split('@')[0] || email,
                    email: email.includes('@') ? email : `${email}@medbuild3d.com`
                };
                
                // حفظ بيانات المستخدم
                localStorage.setItem('medbuild3d_user', JSON.stringify(currentUser));
                isLoggedIn = true;
                
                // تحديث معلومات المستخدم في صفحة الإعدادات
                document.getElementById('settings-username').textContent = currentUser.username;
                document.getElementById('settings-email').textContent = currentUser.email;
                
                // الانتقال المباشر للصفحة الرئيسية
                showPage(mainPage);
                
                // إعادة تعيين النموذج
                document.getElementById('email').value = '';
                document.getElementById('password').value = '';
            }
        });
        
        // إنشاء حساب جديد
        registerBtn.addEventListener('click', function() {
            const email = prompt('الرجاء إدخال بريدك الإلكتروني:');
            if (email) {
                const phone = prompt('الرجاء إدخال رقم هاتفك:');
                if (phone) {
                    alert(`تم إنشاء الحساب بنجاح! تم إرسال رابط التفعيل إلى: ${email}`);
                    
                    // تعبئة الحقول تلقائياً
                    document.getElementById('email').value = email;
                    document.getElementById('password').value = '123456';
                    
                    alert('يمكنك الآن تسجيل الدخول باستخدام البريد الإلكتروني وكلمة المرور الافتراضية (123456)');
                }
            }
        });
        
        // التنقل بين الصفحات
        settingsBtn.addEventListener('click', function() {
            showPage(settingsPage);
        });
        
        theoryBtn.addEventListener('click', function() {
            showPage(theoryPage);
        });
        
        practiceBtn.addEventListener('click', function() {
            showPage(workshopPage);
        });
        
        testsBtn.addEventListener('click', function() {
            showPage(quizPage);
            loadQuestion(currentQuestionIndex);
        });
        
        theoryBackBtn.addEventListener('click', function() {
            showPage(mainPage);
        });
        
        workshopBackBtn.addEventListener('click', function() {
            showPage(mainPage);
        });
        
        quizBackBtn.addEventListener('click', function() {
            showPage(mainPage);
        });
        
        settingsBackBtn.addEventListener('click', function() {
            showPage(mainPage);
        });
        
        // تهيئة النموذج ثلاثي الأبعاد
        function init3DModel() {
            const container = document.getElementById('model-container');
            
            // مسح المحتوى السابق
            container.innerHTML = '';
            
            // إنشاء عنصر canvas للنموذج
            const canvas = document.createElement('canvas');
            canvas.id = 'model-canvas';
            canvas.style.width = '100%';
            canvas.style.height = '100%';
            container.appendChild(canvas);
            
            // تهيئة المشهد
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x000000);
            
            // تهيئة الكاميرا
            camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
            camera.position.set(0, 5, 15);
            
            // تهيئة العارض
            renderer = new THREE.WebGLRenderer({ 
                canvas: canvas, 
                antialias: true,
                alpha: true
            });
            renderer.setSize(container.clientWidth, container.clientHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            
            // إضافة عناصر تحكم
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.25;
            controls.screenSpacePanning = false;
            controls.minDistance = 5;
            controls.maxDistance = 50;
            controls.maxPolarAngle = Math.PI;
            
            // إضافة إضاءة
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(10, 10, 5);
            scene.add(directionalLight);
            
            const pointLight = new THREE.PointLight(0xffffff, 0.5);
            pointLight.position.set(0, 10, 0);
            scene.add(pointLight);
            
            // إنشاء نموذج الجهاز من ملف OBJ كامل
            loadCompleteDeviceModel();
            
            // إعداد أحداث السحب
            setupDragEvents();
            
            // بدء التصيير
            animate();
        }
        
        // تحميل النموذج الكامل للجهاز
        function loadCompleteDeviceModel() {
            const loader = new THREE.OBJLoader();
            
            // تحميل النموذج الكامل للجهاز
            loader.load(
                'https://mohamedsaef233-lang.github.io/Obj/water_bath_complete.obj',
                function(object) {
                    // ضبط المقياس والموقع
                    object.scale.set(2, 2, 2);
                    object.position.set(0, 0, 0);
                    
                    // تطبيق مواد افتراضية
                    object.traverse(function(child) {
                        if (child.isMesh) {
                            child.material = new THREE.MeshPhongMaterial({ 
                                color: 0x1e88e5,
                                shininess: 30,
                                specular: 0x222222
                            });
                        }
                    });
                    
                    scene.add(object);
                    
                    // إخفاء شاشة التحميل
                    document.querySelector('.model-loading').style.display = 'none';
                    
                    // حفظ النموذج الرئيسي
                    modelParts.push({
                        mesh: object,
                        originalPosition: object.position.clone(),
                        originalRotation: object.rotation.clone(),
                        originalScale: object.scale.clone(),
                        id: 'complete-device',
                        name: 'الجهاز الكامل'
                    });
                },
                function(xhr) {
                    const percent = (xhr.loaded / xhr.total * 100);
                    document.querySelector('.model-loading p').textContent = `جاري تحميل النموذج... ${percent.toFixed(1)}%`;
                },
                function(error) {
                    console.error('Error loading complete device model:', error);
                    document.querySelector('.model-loading p').textContent = 'خطأ في تحميل النموذج. جاري تحميل نموذج بديل...';
                    
                    // تحميل نموذج بديل من الأجزاء الفردية
                    loadIndividualParts();
                }
            );
        }
        
        // تحميل الأجزاء الفردية كبديل
        function loadIndividualParts() {
            const loader = new THREE.OBJLoader();
            const parts = [
                { name: 'base', url: 'https://mohamedsaef233-lang.github.io/Obj/base.obj', position: [0, 0, 0] },
                { name: 'tank', url: 'https://mohamedsaef233-lang.github.io/Obj/tank.obj', position: [0, 1, 0] },
                { name: 'heater', url: 'https://mohamedsaef233-lang.github.io/Obj/heater.obj', position: [0, 0.5, 0] },
                { name: 'thermostat', url: 'https://mohamedsaef233-lang.github.io/Obj/thermostat.obj', position: [1, 1.5, 0] },
                { name: 'control-panel', url: 'https://mohamedsaef233-lang.github.io/Obj/control-panel.obj', position: [0, 2, 0.5] },
                { name: 'display', url: 'https://mohamedsaef233-lang.github.io/Obj/display.obj', position: [0, 2.2, 0.6] },
                { name: 'lid', url: 'https://mohamedsaef233-lang.github.io/Obj/lid.obj', position: [0, 2.5, 0] }
            ];
            
            let loadedCount = 0;
            
            parts.forEach(part => {
                loader.load(
                    part.url,
                    function(object) {
                        object.scale.set(1, 1, 1);
                        object.position.set(...part.position);
                        
                        object.traverse(function(child) {
                            if (child.isMesh) {
                                child.material = new THREE.MeshPhongMaterial({ 
                                    color: 0x1e88e5,
                                    shininess: 30
                                });
                            }
                        });
                        
                        scene.add(object);
                        modelParts.push({
                            mesh: object,
                            originalPosition: object.position.clone(),
                            originalRotation: object.rotation.clone(),
                            originalScale: object.scale.clone(),
                            id: part.name,
                            name: part.name
                        });
                        
                        loadedCount++;
                        if (loadedCount === parts.length) {
                            document.querySelector('.model-loading').style.display = 'none';
                        }
                    },
                    function(xhr) {
                        console.log(`${part.name}: ${(xhr.loaded / xhr.total * 100).toFixed(1)}% loaded`);
                    },
                    function(error) {
                        console.error(`Error loading ${part.name}:`, error);
                        loadedCount++;
                    }
                );
            });
        }
        
        // إعداد أحداث السحب
        function setupDragEvents() {
            const canvas = renderer.domElement;
            
            canvas.addEventListener('mousedown', onMouseDown);
            canvas.addEventListener('mousemove', onMouseMove);
            canvas.addEventListener('mouseup', onMouseUp);
            
            canvas.addEventListener('touchstart', onTouchStart);
            canvas.addEventListener('touchmove', onTouchMove);
            canvas.addEventListener('touchend', onTouchEnd);
        }
        
        // أحداث الماوس
        function onMouseDown(event) {
            event.preventDefault();
            const rect = renderer.domElement.getBoundingClientRect();
            mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
            mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
            
            startDrag();
        }
        
        function onMouseMove(event) {
            if (!isDragging) return;
            
            event.preventDefault();
            const rect = renderer.domElement.getBoundingClientRect();
            mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
            mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
            
            updateDrag();
        }
        
        function onMouseUp() {
            endDrag();
        }
        
        // أحداث اللمس
        function onTouchStart(event) {
            event.preventDefault();
            if (event.touches.length === 1) {
                const touch = event.touches[0];
                const rect = renderer.domElement.getBoundingClientRect();
                mouse.x = ((touch.clientX - rect.left) / rect.width) * 2 - 1;
                mouse.y = -((touch.clientY - rect.top) / rect.height) * 2 + 1;
                
                startDrag();
            }
        }
        
        function onTouchMove(event) {
            if (!isDragging || event.touches.length !== 1) return;
            
            event.preventDefault();
            const touch = event.touches[0];
            const rect = renderer.domElement.getBoundingClientRect();
            mouse.x = ((touch.clientX - rect.left) / rect.width) * 2 - 1;
            mouse.y = -((touch.clientY - rect.top) / rect.height) * 2 + 1;
            
            updateDrag();
        }
        
        function onTouchEnd() {
            endDrag();
        }
        
        // بدء السحب
        function startDrag() {
            raycaster.setFromCamera(mouse, camera);
            
            // البحث عن التقاطعات مع النماذج
            const intersects = raycaster.intersectObjects(modelParts.map(p => p.mesh), true);
            
            if (intersects.length > 0) {
                const clickedObject = intersects[0].object;
                
                // البحث عن الجزء الرئيسي الذي ينتمي إليه الكائن
                let clickedPart = null;
                for (const part of modelParts) {
                    if (part.mesh === clickedObject || part.mesh.children.includes(clickedObject)) {
                        clickedPart = part;
                        break;
                    }
                }
                
                if (clickedPart) {
                    selectedPart = clickedPart;
                    isDragging = true;
                    controls.enabled = false;
                    
                    // إعداد مستوى السحب
                    planeNormal.copy(camera.position).normalize();
                    plane.setFromNormalAndCoplanarPoint(planeNormal, scene.position);
                }
            }
        }
        
        // تحديث السحب
        function updateDrag() {
            if (!isDragging || !selectedPart) return;
            
            raycaster.setFromCamera(mouse, camera);
            raycaster.ray.intersectPlane(plane, intersectionPoint);
            
            if (intersectionPoint) {
                selectedPart.mesh.position.copy(intersectionPoint);
            }
        }
        
        // إنهاء السحب
        function endDrag() {
            isDragging = false;
            controls.enabled = true;
            selectedPart = null;
        }
        
        // تفكيك النموذج
        function disassembleModel() {
            if (modelParts.length === 1 && modelParts[0].id === 'complete-device') {
                alert('لا يمكن تفكيك النموذج الكامل. جاري تحميل الأجزاء الفردية...');
                loadIndividualParts();
                return;
            }
            
            modelParts.forEach((part, index) => {
                if (part.id !== 'complete-device') {
                    const targetX = (Math.random() - 0.5) * 8;
                    const targetY = Math.random() * 4;
                    const targetZ = (Math.random() - 0.5) * 8;
                    
                    setTimeout(() => {
                        part.mesh.position.x = targetX;
                        part.mesh.position.y = targetY;
                        part.mesh.position.z = targetZ;
                    }, index * 200);
                }
            });
            
            isAssembled = false;
        }
        
        // تجميع النموذج
        function assembleModel() {
            modelParts.forEach((part, index) => {
                setTimeout(() => {
                    part.mesh.position.copy(part.originalPosition);
                    part.mesh.rotation.copy(part.originalRotation);
                    part.mesh.scale.copy(part.originalScale);
                }, index * 200);
            });
            
            isAssembled = true;
        }
        
        // إعادة تعيين النموذج
        function resetModel() {
            assembleModel();
            selectedPart = null;
            isDragging = false;
            controls.enabled = true;
            controls.reset();
        }
        
        // دورة التصيير
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
        
        // تفعيل أزرار الورشة العملية
        assembleBtn.addEventListener('click', function() {
            if (!isAssembled) {
                assembleModel();
                alert('جاري تجميع جهاز الحمام المائي...');
            } else {
                alert('الجهاز مكون بالفعل!');
            }
        });
        
        disassembleBtn.addEventListener('click', function() {
            if (isAssembled) {
                disassembleModel();
                alert('جاري تفكيك جهاز الحمام المائي...');
            } else {
                alert('الجهاز مفكك بالفعل!');
            }
        });
        
        resetBtn.addEventListener('click', function() {
            resetModel();
            alert('تم إعادة تعيين النموذج');
        });
        
        // تحميل السؤال في صفحة الاختبارات
        function loadQuestion(index) {
            if (index < quizQuestions.length) {
                const question = quizQuestions[index];
                questionText.textContent = question.question;
                
                // تحديث عداد الأسئلة
                document.querySelector('.question-counter').textContent = `السؤال ${index + 1} من ${quizQuestions.length}`;
                
                // إعادة تعيين خيارات الإجابة
                optionsContainer.innerHTML = '';
                
                // إضافة الخيارات
                question.options.forEach((option, i) => {
                    const optionElement = document.createElement('div');
                    optionElement.className = 'option';
                    optionElement.setAttribute('data-value', String.fromCharCode(97 + i));
                    
                    optionElement.innerHTML = `
                        <div class="option-letter">${String.fromCharCode(1573 + i)}</div>
                        <div class="option-text">${option}</div>
                    `;
                    
                    optionElement.addEventListener('click', function() {
                        checkAnswer(this.getAttribute('data-value'), question.correctAnswer);
                    });
                    
                    optionsContainer.appendChild(optionElement);
                });
                
                // إعادة تعيين مساعدات اللعبة
                resetLifelines();
            } else {
                // نهاية الاختبار
                alert(`تهانينا! لقد أكملت الاختبار بنجاح.\n\nنتيجتك: ${calculateScore()} من ${quizQuestions.length}`);
                showPage(mainPage);
                currentQuestionIndex = 0;
            }
        }
        
        // التحقق من الإجابة
        function checkAnswer(selected, correct) {
            const options = document.querySelectorAll('.option');
            
            options.forEach(option => {
                if (option.getAttribute('data-value') === correct) {
                    option.style.backgroundColor = '#43a047';
                    option.style.color = 'white';
                } else if (option.getAttribute('data-value') === selected && selected !== correct) {
                    option.style.backgroundColor = '#e53935';
                    option.style.color = 'white';
                }
                
                option.style.pointerEvents = 'none';
            });
            
            setTimeout(() => {
                currentQuestionIndex++;
                loadQuestion(currentQuestionIndex);
            }, 2000);
        }
        
        // حساب النتيجة
        function calculateScore() {
            return Math.floor(Math.random() * 10) + 5;
        }
        
        // إعادة تعيين مساعدات اللعبة
        function resetLifelines() {
            lifelinesUsed = {
                fiftyFifty: false,
                changeQuestion: false
            };
            
            const lifelines = document.querySelectorAll('.lifeline');
            lifelines.forEach(lifeline => {
                lifeline.classList.remove('disabled');
            });
        }
        
        // تفعيل مساعدات اللعبة
        fiftyFiftyBtn.addEventListener('click', function() {
            if (!lifelinesUsed.fiftyFifty) {
                const currentQuestion = quizQuestions[currentQuestionIndex];
                const correctAnswer = currentQuestion.correctAnswer;
                const options = document.querySelectorAll('.option');
                let removedCount = 0;
                
                options.forEach(option => {
                    if (option.getAttribute('data-value') !== correctAnswer && removedCount < 2) {
                        option.style.opacity = '0.3';
                        option.style.pointerEvents = 'none';
                        removedCount++;
                    }
                });
                
                lifelinesUsed.fiftyFifty = true;
                this.classList.add('disabled');
            }
        });
        
        changeQuestionBtn.addEventListener('click', function() {
            if (!lifelinesUsed.changeQuestion) {
                const newIndex = (currentQuestionIndex + 1) % quizQuestions.length;
                currentQuestionIndex = newIndex;
                loadQuestion(currentQuestionIndex);
                
                lifelinesUsed.changeQuestion = true;
                this.classList.add('disabled');
            }
        });
        
        // التنقل في صفحة الإعدادات
        supportSettings.addEventListener('click', function() {
            supportModal.style.display = 'flex';
        });
        
        aboutSettings.addEventListener('click', function() {
            alert('MedBuild3D - تطبيق تفكيك الأجهزة الطبية\n\nالإصدار: 1.0\nالمطور: Saad Zaki Ibrahim\n\nتطبيق متخصص في تعليم صيانة الأجهزة الطبية');
        });
        
        // تفعيل خيارات الدعم الفني
        whatsappSupport.addEventListener('click', function() {
            const phoneNumber = '+9647734054850';
            window.open(`https://wa.me/${phoneNumber.replace('+', '')}`, '_blank');
        });
        
        phoneSupport.addEventListener('click', function() {
            const phoneNumber = '+9647734054850';
            window.open(`tel:${phoneNumber}`, '_self');
        });
        
        closeSupport.addEventListener('click', function() {
            supportModal.style.display = 'none';
        });
        
        // تهيئة التطبيق
        checkLoginStatus();
    </script>
</body>
</html>